/*
 * Create a Folder structure in the selected Folder
 */
 debug = true;

console.show();
console.clear();
console.log("> Start");

var theFolderRoot = $(selection).filter("folder").first();
if(!theFolderRoot) {
    console.log("!! one Folder must be selected in the Model Explorer")
    exit();
} else {
    debug ? console.log("theFolderRoot = " + theFolderRoot.name) : true;
}

var theFolderStruct;
var theFolderStructArchimate;
var theFolderStructITILV4Practices;

theFolderStructITILV4Practices = [
"Gestion des Services IT",
"Gestion Générale IT",
"Gestion Technique de l'IT"
]
theFolderStructITILV4Practices_GS = [
"Analyse métier",
"Bureau des services",
"Conception des services",
"Contrôle du changement",
"Gestion d'actifs informatiques",
"Gestion de la configuration des services",
"Gestion de la continuité des services",
"Gestion de la disponibilité",
"Gestion des capacités et du rendement",
"Gestion des demandes de services",
"Gestion des incidents",
"Gestion des problèmes",
"Gestion des rejets",
"Gestion du catalogue de services",
"Gestion du niveau des services",
"Suivi et gestion des événements",
"Validation et test des services"
]
theFolderStructITILV4Practices_GG = [
"Amélioration continue",
"Gestion de l'architecture",
"Gestion de la main d'oeuvre et des talents",
"Gestion de la sécurité de l'information",
"Gestion de la stratégie",
"Gestion de portefeuille",
"Gestion de projet",
"Gestion des connaissances",
"Gestion des fournisseurs",
"Gestion des relations",
"Gestion des risques",
"Gestion du changement organisationnel",
"Gestion financière des services",
"Mesures et rapports"
]
theFolderStructITILV4Practices_GT = [
"Gestion de l'Infrastructure et des Plateformes",
"Gestion du déploiement",
"Gestion du dév. et des logiciels"
];


theFolderStruct_Niv1_SousMAMP = [
    "Administration",
    "Alimentation et Agriculture",
    "Aménagement",
    "Attractivité, Culture, Sport",
    "Cohésion",
    "Cycle de l'Eau, Mer et Littoral",
    "Ecologie et Energie",
    "Economie",
    "Gestion urbaine",
    "Habitat",
    "Mobilité"
];

theFolderStruct_Niv2_SousAdministration = [
    "Business Data",
    "Business Intelligence",
    "Communication",
    "Géomatique",
    "Gestion de Patrimoine",
    "Gestion Financière",
    "Gestion IT",
    "Gestion RH",
    "Intelligence Artificielle"
]

// theFolderStruct = theFolderStruct_Niv1_SousMAMP
// ou
// theFolderStruct = theFolderStruct_Niv2_SousAdministration
// ou
theFolderStruct = theFolderStructITILV4Practices

// Identification de la Selction
// .filter().first() is to make sure we work on only one Folder
// (in case of multiple or erroneous selection)
var fold = $(selection).filter('folder').first(); 
console.log('Here is the Selected Folder: ', fold.name, " Id: ", fold.id);


function myCreation(){
    for(i = 0; i < theFolderStruct.length; i++ ){
        debug ? console.log("- " + theFolderStruct[i]) : true;
    }
    // Si c juste pour vérifier activer le Exit() ci-dessous
    // exit();

    for(i = 0; i < theFolderStruct.length; i++ ){
        theFolderRoot.createFolder(theFolderStruct[i]);
        
        // A utiliser avec la Structure ITIL uniquement ?
        //model.createElement("capability",theFolderStruct[i]);
    }
}

console.log("> End");
